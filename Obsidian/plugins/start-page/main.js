/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var G=Object.defineProperty;var J=Object.getOwnPropertyDescriptor;var tt=Object.getOwnPropertyNames;var et=Object.prototype.hasOwnProperty;var st=(h,n)=>{for(var t in n)G(h,t,{get:n[t],enumerable:!0})},nt=(h,n,t,e)=>{if(n&&typeof n=="object"||typeof n=="function")for(let s of tt(n))!et.call(h,s)&&s!==t&&G(h,s,{get:()=>n[s],enumerable:!(e=J(n,s))||e.enumerable});return h};var it=h=>nt(G({},"__esModule",{value:!0}),h);var dt={};st(dt,{default:()=>H});module.exports=it(dt);var k=require("obsidian");var w=require("obsidian");var O={language:"Language",language_desc:"Select language",language_zh:"Chinese",language_en:"English",start_page:"Start page",welcome:"Welcome back \u{1F44B}",recent_notes:"Recent notes",pinned_notes:"Pinned notes",refresh:"Refresh",minutes_ago:"{minutes} minutes ago",hours_ago:"{hours} hours ago",days_ago:"{days} days ago",root_folder:"Root folder",start_page_settings:"Start page settings",recent_notes_limit:"Recent notes limit",recent_notes_limit_desc:"Set the number of recent modified notes to display on the start page",recent_notes_limit_placeholder:"Enter a number",pinned_notes_select:"Select pinned notes",pinned_notes_select_desc:"Select notes to pin on the start page",pinned_notes_select_button:"Select notes",pinned_notes_import_from_bookmarks:"Import from bookmarks",pinned_notes_import_from_bookmarks_desc:"Import pinned notes from Obsidian bookmarks",pinned_notes_import_from_bookmarks_button:"Import bookmarks",import_bookmarks_success:"Successfully imported {count} bookmarks",import_bookmarks_no_bookmarks:"No bookmarks found",import_bookmarks_already_exist:"All bookmarks are already pinned",pinned_notes_remove:"Remove",current_pinned_notes:"Current pinned notes",show_count:"Show count",new_note:"New note",total_notes:"Total notes",today_edited:"Today edited",total_size:"Total size",manage:"Manage",replace_new_tab:"Replace new tab",replace_new_tab_desc:"When opening a new tab, replace it with Start Page",remove_from_pinned_notes:"Remove from pinned notes",add_to_pinned_notes:"Add to pinned notes",move_up:"Move up",move_down:"Move down",open_start_page:"Open start page",open_start_page_desc:"Open the start page in current tab",open_start_page_new_tab:"Open start page in new tab",open_start_page_new_tab_desc:"Open the start page in a new tab",include_all_files_in_recent:"Include all files in recent notes",include_all_files_in_recent_desc:"Include all types of files in the recent notes section, rather than only markdown files",show_title_navigation_bar:"Show title navigation bar",show_title_navigation_bar_desc:"Show the title navigation bar on the start page",show_title_navigation_bar_default:"Default",show_title_navigation_bar_show:"Show",show_title_navigation_bar_hide:"Hide",show_custom_footer_text:"Show custom footer text",show_custom_footer_text_desc:"Show custom footer text on the start page",use_random_footer_text:"Use random footer text",use_random_footer_text_desc:"Show random footer text on the start page",custom_footer_text:"Custom footer text",custom_footer_text_desc:"Set custom footer text for the start page",custom_footer_text_placeholder:"Enter custom footer text",general_settings_heading:"General",appearance_settings_heading:"Appearance",new_tab_settings_heading:"New Tab",footer_settings_heading:"Footer",pinned_notes_settings_heading:"Pinned Notes",default_footer_text:"I think, therefore I am. \u2014 Ren\xE9 Descartes",loading_footer_text:"Loading...",search_modal_title:"Search",search_placeholder:"Type to start search...",case_sensitive:"Case sensitive",no_results:"No matching results.",no_results_press_enter:'No matching results. Press <b>Enter</b> to create a new note "<b>{query}</b>".',show_stat_bar:"Show stat. bar",show_stat_bar_desc:"Show stat. bar on the start page",new_version_available:"New version available",update_to_version:"Update to v{version}",search_settings_heading:"Search",search_exclude_list:"Exclude list",search_exclude_list_desc:"Files and folders to exclude from search results",search_exclude_list_add_button:"Add file or folder",search_exclude_list_remove:"Remove from exclude list",current_search_exclude_list:"Current exclude list",search_exclude_settings:"Exclude settings",search_exclude_settings_tooltip:"Excluded: {list}"};var K={language:"\u8BED\u8A00",language_desc:"\u9009\u62E9\u8BED\u8A00",language_zh:"\u4E2D\u6587",language_en:"\u82F1\u6587",start_page:"\u542F\u52A8\u9996\u9875",welcome:"\u6B22\u8FCE\u56DE\u6765\u{1F44B}",recent_notes:"\u6700\u8FD1\u7B14\u8BB0",pinned_notes:"\u7F6E\u9876\u7B14\u8BB0",refresh:"\u5237\u65B0",minutes_ago:"{minutes}\u5206\u949F\u524D",hours_ago:"{hours}\u5C0F\u65F6\u524D",days_ago:"{days}\u5929\u524D",root_folder:"\u7B14\u8BB0\u5E93",start_page_settings:"\u542F\u52A8\u9996\u9875\u8BBE\u7F6E",recent_notes_limit:"\u6700\u8FD1\u4FEE\u6539\u7B14\u8BB0\u663E\u793A\u6570\u91CF",recent_notes_limit_desc:"\u8BBE\u7F6E\u542F\u52A8\u9996\u9875\u663E\u793A\u7684\u6700\u8FD1\u4FEE\u6539\u7B14\u8BB0\u6570\u91CF",recent_notes_limit_placeholder:"\u8F93\u5165\u6570\u5B57",pinned_notes_select:"\u9009\u62E9\u7F6E\u9876\u7B14\u8BB0",pinned_notes_select_desc:"\u9009\u62E9\u8981\u5728\u542F\u52A8\u9996\u9875\u7F6E\u9876\u663E\u793A\u7684\u7B14\u8BB0",pinned_notes_select_button:"\u9009\u62E9\u7B14\u8BB0",pinned_notes_import_from_bookmarks:"\u4ECE\u4E66\u7B7E\u5BFC\u5165",pinned_notes_import_from_bookmarks_desc:"\u4ECE Obsidian \u4E66\u7B7E\u5BFC\u5165\u7F6E\u9876\u7B14\u8BB0",pinned_notes_import_from_bookmarks_button:"\u5BFC\u5165\u4E66\u7B7E",import_bookmarks_success:"\u6210\u529F\u5BFC\u5165 {count} \u4E2A\u4E66\u7B7E",import_bookmarks_no_bookmarks:"\u672A\u627E\u5230\u4E66\u7B7E",import_bookmarks_already_exist:"\u6240\u6709\u4E66\u7B7E\u5DF2\u7ECF\u88AB\u7F6E\u9876",pinned_notes_remove:"\u79FB\u9664",current_pinned_notes:"\u5F53\u524D\u7F6E\u9876\u7B14\u8BB0",show_count:"\u663E\u793A\u6570\u91CF",new_note:"\u65B0\u5EFA\u7B14\u8BB0",total_notes:"\u603B\u7B14\u8BB0\u6570",today_edited:"\u4ECA\u65E5\u7F16\u8F91",total_size:"\u603B\u5360\u7528\u7A7A\u95F4",manage:"\u7BA1\u7406",replace_new_tab:"\u66FF\u6362\u65B0\u6807\u7B7E\u9875",replace_new_tab_desc:"\u6253\u5F00\u65B0\u6807\u7B7E\u9875\u65F6\uFF0C\u4F7F\u7528\u542F\u52A8\u9996\u9875\u66FF\u6362\u9ED8\u8BA4\u7684\u65B0\u6807\u7B7E\u9875",remove_from_pinned_notes:"\u4ECE\u7F6E\u9876\u7B14\u8BB0\u79FB\u9664",add_to_pinned_notes:"\u6DFB\u52A0\u5230\u7F6E\u9876\u7B14\u8BB0",move_up:"\u4E0A\u79FB",move_down:"\u4E0B\u79FB",open_start_page:"\u6253\u5F00\u542F\u52A8\u9996\u9875",open_start_page_desc:"\u5728\u5F53\u524D\u6807\u7B7E\u9875\u6253\u5F00\u542F\u52A8\u9996\u9875",open_start_page_new_tab:"\u5728\u65B0\u6807\u7B7E\u9875\u6253\u5F00\u542F\u52A8\u9996\u9875",open_start_page_new_tab_desc:"\u5728\u65B0\u6807\u7B7E\u9875\u4E2D\u6253\u5F00\u542F\u52A8\u9996\u9875",include_all_files_in_recent:"\u5728\u6700\u8FD1\u4FEE\u6539\u7B14\u8BB0\u4E2D\u5305\u542B\u6240\u6709\u6587\u4EF6",include_all_files_in_recent_desc:"\u5728\u6700\u8FD1\u4FEE\u6539\u7B14\u8BB0\u4E2D\u5305\u542B\u6240\u6709\u7C7B\u578B\u7684\u6587\u4EF6\uFF0C\u800C\u4E0D\u4EC5\u4EC5\u662FMarkdown\u6587\u4EF6",show_title_navigation_bar:"\u663E\u793A\u6807\u9898\u5BFC\u822A\u680F",show_title_navigation_bar_desc:"\u5728\u542F\u52A8\u9996\u9875\u4E2D\u663E\u793A\u6807\u9898\u5BFC\u822A\u680F",show_title_navigation_bar_default:"\u9ED8\u8BA4",show_title_navigation_bar_show:"\u663E\u793A",show_title_navigation_bar_hide:"\u9690\u85CF",show_custom_footer_text:"\u663E\u793A\u81EA\u5B9A\u4E49\u9875\u811A\u6587\u672C",show_custom_footer_text_desc:"\u5728\u542F\u52A8\u9996\u9875\u4E2D\u663E\u793A\u81EA\u5B9A\u4E49\u9875\u811A\u6587\u672C",use_random_footer_text:"\u4F7F\u7528\u968F\u673A\u9875\u811A\u6587\u672C",use_random_footer_text_desc:"\u5728\u542F\u52A8\u9996\u9875\u4E2D\u663E\u793A\u968F\u673A\u9875\u811A\u6587\u672C",custom_footer_text:"\u81EA\u5B9A\u4E49\u9875\u811A\u6587\u672C",custom_footer_text_desc:"\u8BBE\u7F6E\u542F\u52A8\u9996\u9875\u7684\u81EA\u5B9A\u4E49\u9875\u811A\u6587\u672C",custom_footer_text_placeholder:"\u8F93\u5165\u81EA\u5B9A\u4E49\u9875\u811A\u6587\u672C",general_settings_heading:"\u5E38\u89C4",appearance_settings_heading:"\u5916\u89C2",new_tab_settings_heading:"\u65B0\u6807\u7B7E\u9875",footer_settings_heading:"\u9875\u811A",pinned_notes_settings_heading:"\u56FA\u5B9A\u7684\u7B14\u8BB0",default_footer_text:"\u5929\u884C\u5065,\u541B\u5B50\u4EE5\u81EA\u5F3A\u4E0D\u606F\u3002\u2014\u2014\u300A\u5468\u6613\u300B",loading_footer_text:"\u52A0\u8F7D\u4E2D...",search_modal_title:"\u641C\u7D22",search_placeholder:"\u8F93\u5165\u641C\u7D22\u5185\u5BB9",case_sensitive:"\u533A\u5206\u5927\u5C0F\u5199",no_results:"\u6CA1\u6709\u627E\u5230\u5339\u914D\u7684\u7ED3\u679C\u3002",no_results_press_enter:'\u6CA1\u6709\u627E\u5230\u5339\u914D\u7684\u7ED3\u679C\u3002\u6309 <b>Enter</b> \u952E\u521B\u5EFA\u65B0\u7B14\u8BB0 "<b>{query}</b>"\u3002',show_stat_bar:"\u663E\u793A\u7EDF\u8BA1\u680F",show_stat_bar_desc:"\u5728\u542F\u52A8\u9996\u9875\u4E2D\u663E\u793A\u7EDF\u8BA1\u680F",new_version_available:"\u6709\u65B0\u7248\u672C\u53EF\u7528",update_to_version:"\u66F4\u65B0\u5230 v{version}",search_settings_heading:"\u641C\u7D22",search_exclude_list:"\u6392\u9664\u5217\u8868",search_exclude_list_desc:"\u4ECE\u641C\u7D22\u7ED3\u679C\u4E2D\u6392\u9664\u7684\u6587\u4EF6\u548C\u6587\u4EF6\u5939",search_exclude_list_add_button:"\u6DFB\u52A0\u6587\u4EF6\u6216\u6587\u4EF6\u5939",search_exclude_list_remove:"\u4ECE\u6392\u9664\u5217\u8868\u79FB\u9664",current_search_exclude_list:"\u5F53\u524D\u6392\u9664\u5217\u8868",search_exclude_settings:"\u6392\u9664\u8BBE\u7F6E",search_exclude_settings_tooltip:"\u5DF2\u6392\u9664: {list}"};var Z={en:O,zh:K},rt="en",j=O;function $(h){Z[h]&&(rt=h,j=Z[h])}function o(h){return j[h]||h}var F="totalNotes",L="todayEdited",A="totalSize",U={includeAllFilesInRecent:!0,recentNotesLimit:10,pinnedNotes:[],replaceNewTab:!0,showTitleNavigationBar:"default",showCustomFooterText:!1,useRandomFooterText:!1,todayRandomEnFooterText:"",todayRandomZhFooterText:"",customFooterText:"",scrollPosition:0,showStatBar:!0,lastVersionCheck:0,latestVersion:"",excludeList:[]};var Q=require("obsidian");var I=require("obsidian"),lt="https://zenquotes.io/api/random",ct="https://v2.jinrishici.com/one.json?client=browser-sdk/1.2",S=class{static async getFooterText(n){let t=n.settings;return t.showCustomFooterText?t.useRandomFooterText?((0,I.getLanguage)()||"en")==="zh"?await S.getChineseRandomFooterText(n):await S.getEnglishRandomFooterText(n):t.customFooterText||o("default_footer_text"):o("default_footer_text")}static async getChineseRandomFooterText(n){let t=n.settings,e=new Date().toISOString().slice(0,10);if(t.todayRandomZhFooterText&&t.todayRandomZhFooterText.startsWith(e))return t.todayRandomZhFooterText.split("|")[1];try{let s=await(0,I.requestUrl)(ct);if(s.status===200){let i=await s.json,a=`${i.data.content} - ${i.data.origin.author}`;return t.todayRandomZhFooterText=`${e}|${a}`,n.saveSettings(),a}else console.log("Error fetching Chinese footer text:",s.status,s.text)}catch(s){console.log("Error fetching Chinese footer text:",s)}return o("default_footer_text")}static async getEnglishRandomFooterText(n){let t=n.settings,e=new Date().toISOString().slice(0,10);if(t.todayRandomEnFooterText&&t.todayRandomEnFooterText.startsWith(e))return t.todayRandomEnFooterText.split("|")[1];try{let s=await(0,I.requestUrl)(lt);if(s.status===200){let i=await s.json,a=`${i[0].q} - ${i[0].a}`;return t.todayRandomEnFooterText=`${e}|${a}`,n.saveSettings(),a}else console.log("Error fetching English footer text:",s.status,s.text)}catch(s){console.log("Error fetching English footer text:",s)}return o("default_footer_text")}};var z=class{static createFolderIcon(){let n="http://www.w3.org/2000/svg",t=document.createElementNS(n,"svg");t.setAttribute("viewBox","0 0 24 24"),t.setAttribute("width","14"),t.setAttribute("height","14");let e=document.createElementNS(n,"path");return e.setAttribute("d","M2 6a2 2 0 0 1 2-2h5l2 2h9a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6z"),e.setAttribute("fill","currentColor"),t.appendChild(e),t}static createArrowUpIcon(){let n="http://www.w3.org/2000/svg",t=document.createElementNS(n,"svg");t.setAttribute("viewBox","0 0 24 24"),t.setAttribute("width","16"),t.setAttribute("height","16");let e=document.createElementNS(n,"path");return e.setAttribute("d","M12 8l-6 6h12l-6-6z"),e.setAttribute("fill","currentColor"),t.appendChild(e),t}static createArrowDownIcon(){let n="http://www.w3.org/2000/svg",t=document.createElementNS(n,"svg");t.setAttribute("viewBox","0 0 24 24"),t.setAttribute("width","16"),t.setAttribute("height","16");let e=document.createElementNS(n,"path");return e.setAttribute("d","M12 16l6-6H6l6 6z"),e.setAttribute("fill","currentColor"),t.appendChild(e),t}static createRemoveIcon(){let n="http://www.w3.org/2000/svg",t=document.createElementNS(n,"svg");t.setAttribute("viewBox","0 0 24 24"),t.setAttribute("width","16"),t.setAttribute("height","16");let e=document.createElementNS(n,"path");return e.setAttribute("d","M6 7h12v2H6V7zm2 2h8l-1 9H9l-1-9zm2-4h4l1 2H9l1-2z"),e.setAttribute("fill","currentColor"),t.appendChild(e),t}static createFilterIcon(){let n="http://www.w3.org/2000/svg",t=document.createElementNS(n,"svg");t.setAttribute("viewBox","0 0 24 24"),t.setAttribute("width","16"),t.setAttribute("height","16");let e=document.createElementNS(n,"path");return e.setAttribute("d","M3 4h18v2.4l-7 7V20l-4 2v-9l-7-7V4z"),e.setAttribute("stroke","currentColor"),e.setAttribute("stroke-width","2"),e.setAttribute("fill","none"),e.setAttribute("stroke-linecap","round"),e.setAttribute("stroke-linejoin","round"),t.appendChild(e),t}static createFileIcon(n){return z.createSVG(this.iconSVGs[n]||this.iconSVGs.md)}static createEditIcon(){return this.createSVG([{tagName:"path",attributes:{d:"M11 4H4A2 2 0 0 0 2 6V20A2 2 0 0 0 4 22H18A2 2 0 0 0 20 20V13"}},{tagName:"path",attributes:{d:"M18.5 2.5L22 6L12 16H6V10L18.5 2.5Z"}}])}static createRefreshIcon(){return this.createSVG([{tagName:"path",attributes:{d:"M3 2v6h6"}},{tagName:"path",attributes:{d:"M3 13a9 9 0 1 0 3-7.7L3 8"}}],"refresh-icon")}static createLogoIcon(){return this.createSVG([{tagName:"path",attributes:{d:"M12 2L2 7L12 12L22 7L12 2Z","stroke-linecap":"none"}},{tagName:"path",attributes:{d:"M2 17L12 22L22 17","stroke-linecap":"none"}},{tagName:"path",attributes:{d:"M2 12L12 17L22 12","stroke-linecap":"none"}}],"logo-icon")}static createNewNoteIcon(){return this.createSVG([{tagName:"path",attributes:{d:"M12 5V19"}},{tagName:"path",attributes:{d:"M5 12H19"}}],"new-note-icon")}static createPinnedNoteIcon(){return this.createSVG([{tagName:"path",attributes:{d:"M12 2L13.09 8.26L20 9L13.09 9.74L12 16L10.91 9.74L4 9L10.91 8.26L12 2Z",fill:"currentColor"}}],"section-icon")}static createRecentNoteIcon(){return this.createSVG([{tagName:"path",attributes:{d:"M12 8V12L15 15"}},{tagName:"circle",attributes:{cx:12,cy:12,r:10,stroke:"currentColor","stroke-width":2}}],"section-icon")}static createStatIcon(n){return n===F?this.createSVG([{tagName:"path",attributes:{d:"M14 2H6A2 2 0 0 0 4 4V20A2 2 0 0 0 6 22H18A2 2 0 0 0 20 20V8L14 2Z"}},{tagName:"path",attributes:{d:"M14 2V8H20"}}]):n===L?this.createSVG([{tagName:"path",attributes:{d:"M12 8V12L15 15"}},{tagName:"circle",attributes:{cx:12,cy:12,r:10,stroke:"currentColor","stroke-width":2}}]):n===A?this.createSVG([{tagName:"rect",attributes:{x:"3",y:"6",width:"18",height:"12",rx:"2",ry:"2",stroke:"currentColor","stroke-width":"2",fill:"none"}},{tagName:"circle",attributes:{cx:"7",cy:"12",r:"1",fill:"currentColor"}},{tagName:"path",attributes:{d:"M11 10H17",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"}},{tagName:"path",attributes:{d:"M11 14H15",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"}}]):null}static createSVG(n,t=null){let e=document.createElementNS("http://www.w3.org/2000/svg","svg");return e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),t&&e.setAttribute("class",t),n.forEach(s=>{let i=document.createElementNS("http://www.w3.org/2000/svg",s.tagName);s.tagName==="path"&&!s.attributes.fill&&(s.attributes.stroke=s.attributes.stroke||"currentColor",s.attributes["stroke-width"]=s.attributes["stroke-width"]||"2",s.attributes["stroke-linecap"]=s.attributes["stroke-linecap"]||"round",s.attributes["stroke-linejoin"]=s.attributes["stroke-linejoin"]||"round");for(let[a,r]of Object.entries(s.attributes))r!==void 0&&(typeof r=="number"&&(r=r.toString()),i.setAttribute(a,r));e.appendChild(i)}),e}},p=z;p.iconSVGs={md:[{tagName:"path",attributes:{d:"M14 2H6A2 2 0 0 0 4 4V20A2 2 0 0 0 6 22H18A2 2 0 0 0 20 20V8L14 2Z"}},{tagName:"path",attributes:{d:"M14 2V8H20"}}],base:[{tagName:"rect",attributes:{x:"4",y:"3",width:"16",height:"20",rx:"2",stroke:"currentColor","stroke-width":"2",fill:"none"}},{tagName:"path",attributes:{d:"M6 10H18",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round"}},{tagName:"path",attributes:{d:"M6 16H18",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round"}},{tagName:"path",attributes:{d:"M10 4V24",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round"}}],canvas:[{tagName:"rect",attributes:{x:"4",y:"3",width:"16",height:"20",rx:"2",stroke:"currentColor","stroke-width":"2",fill:"none"}},{tagName:"circle",attributes:{cx:"8",cy:"9",r:"2",fill:"currentColor"}},{tagName:"circle",attributes:{cx:"16",cy:"9",r:"2",fill:"currentColor"}},{tagName:"circle",attributes:{cx:"12",cy:"17",r:"2",fill:"currentColor"}},{tagName:"path",attributes:{d:"M10 9L14 9",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round"}},{tagName:"path",attributes:{d:"M9.4 10.6L12 15",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round"}},{tagName:"path",attributes:{d:"M14.6 10.6L12 15",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round"}}]};var _=class{static truncateMiddle(n,t=24,e=16){if(!n||n.length<=t+e+3)return n;let i=n.slice(0,t),a=n.slice(-e);return`${i}...${a}`}static getDirPath(n){if(!n)return"/";let t=n.lastIndexOf("/");return t===-1?"/":"/"+n.slice(0,t)}static getFileNameWithoutExtension(n){return n.slice(0,n.lastIndexOf("."))}static formatDate(n){let t=new Date(n),s=new Date().getTime()-t.getTime();if(s<24*60*60*1e3){let i=Math.floor(s/36e5);if(i===0){let a=Math.floor(s/6e4);return o("minutes_ago").replace("{minutes}",a.toString())}return o("hours_ago").replace("{hours}",i.toString())}if(s<7*24*60*60*1e3){let i=Math.floor(s/864e5);return o("days_ago").replace("{days}",i.toString())}return t.toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}static formatSize(n){return n<1024?n+"B":n<1024*1024?(n/1024).toFixed(0)+"KB":n<1024*1024*1024?(n/(1024*1024)).toFixed(0)+"MB":(n/(1024*1024*1024)).toFixed(0)+"GB"}};var y=require("obsidian"),P=class extends y.Modal{constructor(t,e,s,i=""){super(t);this.initialQuery="";this.selectedIndex=-1;this.caseSensitive=!1;this.plugin=e,this.setTitle(o("search_modal_title")),this.allFiles=this.app.vault.getFiles(),this.filteredResults=[],this.onChooseItem=s,this.initialQuery=i}onOpen(){let{contentEl:t,modalEl:e}=this;t.addClass("my-search-content"),e.addClass("my-search-modal");let s=t.createDiv("search-container");this.searchComponent=new y.SearchComponent(s),this.searchComponent.setPlaceholder(o("search_placeholder")).onChange(d=>{this.performSearch(d)});let i=s.createEl("button",{cls:"search-exclude-settings-btn",attr:{title:this.getExcludeTooltip()}}),a=p.createFilterIcon();i.appendChild(a),i.addEventListener("click",d=>{d.preventDefault(),this.openExcludeSettings()});let r=s.createEl("button",{cls:"search-case-sensitive-btn",attr:{title:o("case_sensitive")}});r.setText("Aa"),this.updateCaseSensitiveButton(r),r.addEventListener("click",d=>{d.preventDefault(),this.caseSensitive=!this.caseSensitive,this.updateCaseSensitiveButton(r);let c=this.searchComponent.getValue();c&&this.performSearch(c)}),this.resultsContainer=t.createDiv("search-results-container"),this.initialQuery&&(this.searchComponent.setValue(this.initialQuery),this.performSearch(this.initialQuery)),this.searchComponent.inputEl.focus(),this.setupKeyboardNavigation()}onClose(){let{contentEl:t}=this;t.empty()}updateCaseSensitiveButton(t){this.caseSensitive?t.addClass("is-active"):t.removeClass("is-active")}performSearch(t){if(t==="")this.filteredResults=[];else if(this.caseSensitive)this.filteredResults=this.allFiles.filter(e=>{var a,r;if(this.isFileExcluded(e))return!1;if(e.name.includes(t))return!0;let s=this.app.metadataCache.getFileCache(e),i=((a=s==null?void 0:s.frontmatter)==null?void 0:a.aliases)||((r=s==null?void 0:s.frontmatter)==null?void 0:r.alias);return i?(Array.isArray(i)?i:[i]).some(c=>typeof c=="string"&&c.includes(t)):!1});else{let e=t.toLowerCase();this.filteredResults=this.allFiles.filter(s=>{var r,d;if(this.isFileExcluded(s))return!1;if(s.name.toLowerCase().includes(e))return!0;let i=this.app.metadataCache.getFileCache(s),a=((r=i==null?void 0:i.frontmatter)==null?void 0:r.aliases)||((d=i==null?void 0:i.frontmatter)==null?void 0:d.alias);return a?(Array.isArray(a)?a:[a]).some(g=>typeof g=="string"&&g.toLowerCase().includes(e)):!1})}this.renderResults()}renderResults(){var e,s;if(this.resultsContainer.empty(),this.selectedIndex=-1,this.filteredResults.length===0){let i=this.resultsContainer.createDiv("search-empty-state"),a=this.searchComponent.getValue();a?i.innerHTML=o("no_results_press_enter").replace("{query}",a):i.setText(o("no_results"));return}let t=this.resultsContainer.createEl("ul",{cls:"search-results-list"});for(let i=0;i<this.filteredResults.length;i++){let a=this.filteredResults[i],r=t.createEl("li",{cls:"search-result-item"}),d=_.getFileNameWithoutExtension(a.name),c=document.createElement("span");c.addClass("search-result-item-file-name"),c.setText(d),r.setAttribute("title",d),r.appendChild(c);let g=this.searchComponent.getValue(),u=this.app.metadataCache.getFileCache(a),x=((e=u==null?void 0:u.frontmatter)==null?void 0:e.aliases)||((s=u==null?void 0:u.frontmatter)==null?void 0:s.alias),T=this.getMatchedAlias(x,g);if(T){let b=document.createElement("span");b.addClass("search-result-item-alias"),b.setText(T),r.appendChild(b)}let E=document.createElement("span");if(E.addClass("search-result-item-tag"),r.appendChild(E),(a.extension.toLowerCase()==="canvas"||a.extension.toLowerCase()==="base")&&E.setText(a.extension.toUpperCase()),a.parent&&!a.parent.isRoot()){let b=a.parent.name,f=document.createElement("span"),C=p.createFolderIcon();f.setText(b),f.addClass("search-result-item-folder-name"),C.addClass("search-result-item-folder-icon"),r.appendChild(C),r.appendChild(f)}r.onClickEvent(()=>{this.onChooseItem(a),this.close()})}this.filteredResults.length>0&&this.setActiveIndex(0)}setupKeyboardNavigation(){this.searchComponent.inputEl.addEventListener("keydown",t=>{if(t.key==="Enter"){if(t.preventDefault(),this.filteredResults.length===0){let e=this.searchComponent.getValue().trim();e&&this.createNewNote(e)}else if(this.selectedIndex>=0&&this.selectedIndex<this.filteredResults.length){let e=this.filteredResults[this.selectedIndex];this.onChooseItem(e),this.close()}return}if(this.filteredResults.length!==0){if(t.key==="ArrowDown")t.preventDefault(),this.setActiveIndex((this.selectedIndex+1)%this.filteredResults.length);else if(t.key==="ArrowUp"){t.preventDefault();let e=this.selectedIndex-1;this.setActiveIndex(e<0?this.filteredResults.length-1:e)}}})}setActiveIndex(t){let e=this.resultsContainer.querySelectorAll(".search-result-item");e.forEach(s=>s.removeClass("is-active")),t>=0&&t<e.length&&(this.selectedIndex=t,e[t].addClass("is-active"),e[t].scrollIntoView({block:"nearest",behavior:"smooth"}))}async createNewNote(t){try{let s=`${t.replace(/[\\/:*?"<>|]/g,"")}.md`,i=this.app.vault.getAbstractFileByPath(s);if(i)i instanceof y.TFile&&await this.app.workspace.getLeaf().openFile(i);else{let a=await this.app.vault.create(s,"");await this.app.workspace.getLeaf().openFile(a)}this.close()}catch(e){console.error("Failed to create new note:",e)}}getMatchedAlias(t,e){if(!t||!e)return null;let s=Array.isArray(t)?t:[t],i=this.caseSensitive?e:e.toLowerCase();for(let a of s){if(typeof a!="string")continue;if((this.caseSensitive?a:a.toLowerCase()).includes(i))return a}return null}isFileExcluded(t){let e=this.plugin.settings.excludeList;if(e.length===0)return!1;for(let s of e)if(t.path===s||t.path.startsWith(s+"/"))return!0;return!1}getExcludeTooltip(){let t=this.plugin.settings.excludeList;if(t.length===0)return o("search_exclude_settings_tooltip").replace("{list}",o("no_results"));let e=t.length<=3?t.join(", "):t.slice(0,3).join(", ")+"...";return o("search_exclude_settings_tooltip").replace("{list}",e)}openExcludeSettings(){this.close(),this.app.setting.open(),this.app.setting.openTabById(this.plugin.manifest.id)}};var R=class{constructor(n,t,e){this.initialQuery="";this.stats=[{id:F,data:{number:0,label:function(){return o("total_notes")}}},{id:L,data:{number:0,label:function(){return o("today_edited")}}},{id:A,data:{number:"0",label:function(){return o("total_size")}}}];this.pinnedNotes=null;this.recentNotes=null;this.app=n,this.plugin=t,this.container=e}async createStartPage(n,t){this.initData(n,t),this.container.empty(),this.container.addClass("start-page-container");let e=this.createHeader(),s=this.createMainContent(),i=await this.createFooter();this.container.appendChild(e),this.container.appendChild(s),this.container.appendChild(i),this.setupGlobalKeyListener()}destroy(){this.removeGlobalKeyListener()}initData(n,t){this.pinnedNotes=n,this.recentNotes=t,this.stats.forEach(e=>{e.id===F?e.data.number=this.app.vault.getMarkdownFiles().length:e.id===L?e.data.number=this.getTodayModifiedNoteCount():e.id===A&&(e.data.number=_.formatSize(this.getTotalSize()))})}async updateNoteModifiedTimes(n){for(let t of n){let e=this.container.querySelector(`[data-note-path="${t.path}"] .note-date`);if(e){let s=_.formatDate(t.stat.mtime);e.textContent=s}}}createHeader(){let n=this.createElement("header","header"),t=this.createElement("div","logo"),e=p.createLogoIcon(),s=this.createElement("span","logo-text","Start Page for Obsidian");this.searchBox=this.createElement("input","search-box",""),this.searchBox.type="text",this.searchBox.placeholder=o("search_placeholder"),this.searchBox.addEventListener("click",r=>{this.showSearchModal()}),this.searchBox.addEventListener("focus",r=>{r.target.blur()});let i=this.createElement("div","search-box-container");i.appendChild(this.searchBox),t.appendChild(e),t.appendChild(s),t.appendChild(i);let a=this.createElement("div","header-actions");if(this.hasUpdate()){let r=this.createUpdateBadge();a.appendChild(r)}return n.appendChild(t),n.appendChild(a),n}createStatsSection(){let n=this.createElement("div","stats-section");return this.stats.forEach(t=>{let e=this.createElement("div","stat-card"),s=this.createElement("div","stat-icon"),i=p.createStatIcon(t.id);s.appendChild(i);let a=this.createElement("div","stat-content"),r=this.createElement("div","stat-number",t.data.number.toString()),d=this.createElement("div","stat-label",t.data.label());a.appendChild(r),a.appendChild(d),e.appendChild(s),e.appendChild(a),n.appendChild(e),e.addEventListener("click",()=>{this.showSearchModal()})}),n}createNoteItem(n,t=!1){if(!n)return null;let e=this.createElement("div",`note-item${t?" pinned":""}`);e.setAttribute("data-note-path",n.path),e.addEventListener("click",async()=>{let f=this.app.workspace.getLeavesOfType("markdown").find(C=>C.view.getState().file===n.path);f?await this.app.workspace.revealLeaf(f):this.app.workspace.openLinkText(n.path,"",!1)}),t&&e.addEventListener("contextmenu",f=>{f.preventDefault(),f.stopPropagation();let C=new Q.Menu;C.addItem(W=>{W.setTitle(o("remove_from_pinned_notes")).setIcon("pin-off").onClick(async()=>{this.plugin.settings.pinnedNotes=this.plugin.settings.pinnedNotes.filter(X=>X!==n.path),await this.plugin.saveSettings(),this.refreshStartPage()})}),C.showAtMouseEvent(f)});let s=this.createElement("div","note-icon"),i=n.extension,a=p.createFileIcon(i);s.appendChild(a);let r=this.createElement("div","note-content"),d=this.createElement("div","note-title",n.basename),c=this.createElement("div","note-meta",""),g=_.formatDate(n.stat.mtime),u=n.parent?n.parent.path:"/";u.startsWith("/")||(u="/"+u),c.appendChild(this.createElement("div","note-date",g));let x=p.createFolderIcon();c.appendChild(x),c.appendChild(this.createElement("div","note-folder",_.truncateMiddle(u))),d.setAttribute("title",n.basename),r.appendChild(d),r.appendChild(c);let T=this.createElement("div","note-actions"),E=this.createElement("button","btn-icon"),b=p.createEditIcon();return E.appendChild(b),T.appendChild(E),e.appendChild(s),e.appendChild(r),e.appendChild(T),e}createNotesSection(n,t,e=!1,s){let i=this.createElement("section","section"),a=this.createElement("div","section-header"),r=this.createElement("h2","section-title");if(r.appendChild(s),r.appendChild(document.createTextNode(n)),e){let c=this.createElement("button","btn btn-text",o("manage"));c.addEventListener("click",()=>{let g=this.app.setting;g.open(),setTimeout(()=>{g.openTabById(this.plugin.manifest.id)},100)}),a.appendChild(r),a.appendChild(c)}else{let c=this.createRecentNotesLimitDropdown();a.appendChild(r),a.appendChild(c)}let d=this.createElement("div","notes-list");return t&&t.forEach(c=>{let g=this.createNoteItem(c,e);g&&d.appendChild(g)}),i.appendChild(a),i.appendChild(d),i}createContentGrid(){let n=this.createElement("div","content-grid"),t=this.createNotesSection(o("pinned_notes"),this.pinnedNotes,!0,p.createPinnedNoteIcon());t.classList.add("pinned-notes");let e=this.createNotesSection(o("recent_notes"),this.recentNotes,!1,p.createRecentNoteIcon());return e.classList.add("recent-notes"),n.appendChild(t),n.appendChild(e),n}createMainContent(){let n=this.createElement("main","main-content");if(this.plugin.settings.showStatBar){let e=this.createStatsSection();n.appendChild(e)}let t=this.createContentGrid();return n.appendChild(t),n}async createFooter(){let n=this.createElement("footer","footer"),t=this.createElement("p","",o("default_footer_text"));return n.appendChild(t),this.updateFooterTextAsync(t),n}async updateFooterTextAsync(n){try{let t=await S.getFooterText(this.plugin);if(n.textContent=t,this.plugin.settings.showCustomFooterText&&this.plugin.settings.useRandomFooterText&&!n.querySelector("#refresh-footer-text")){let e=p.createRefreshIcon();e.setAttribute("id","refresh-footer-text"),e.addEventListener("click",()=>{this.plugin.settings.todayRandomEnFooterText="",this.plugin.settings.todayRandomZhFooterText="",this.plugin.saveSettings(),n.textContent=o("loading_footer_text"),this.updateFooterTextAsync(n)}),n.appendChild(e)}}catch(t){console.error("Failed to load footer text:",t)}}createElement(n,t="",e=""){let s=document.createElement(n);return t&&(s.className=t),e&&(s.textContent=e),s}refreshStartPage(){this.app.workspace.getLeavesOfType(m).forEach(t=>{if(t.view instanceof v){t.view.renderContent();return}})}createRecentNotesLimitDropdown(){let n=document.createElement("select");for(let s=5;s<=50;s+=5){let i=document.createElement("option");i.value=s.toString(),i.textContent=s.toString(),n.appendChild(i),s===this.plugin.settings.recentNotesLimit&&(i.selected=!0)}n.addEventListener("change",()=>{let s=parseInt(n.value,10);this.plugin.settings.recentNotesLimit=s,this.plugin.saveSettings(),this.refreshStartPage()});let t=document.createElement("label");t.className="recent-notes-limit-label",t.textContent=o("show_count"),t.htmlFor=n.id;let e=document.createElement("div");return e.appendChild(t),e.appendChild(n),e}getTodayModifiedNoteCount(){let n=new Date;return n.setHours(0,0,0,0),this.app.vault.getMarkdownFiles().filter(s=>s.stat.mtime>=n.getTime()).length}getTotalSize(){let n=this.plugin.settings.includeAllFilesInRecent?this.app.vault.getFiles():this.app.vault.getMarkdownFiles(),t=0;return n.forEach(e=>{t+=e.stat.size}),t}setupGlobalKeyListener(){this.globalKeyHandler=n=>{this.app.workspace.getActiveViewOfType(v)&&(n.ctrlKey||n.altKey||n.metaKey||n.shiftKey||n.key.length===1&&(n.target instanceof HTMLInputElement||n.target instanceof HTMLTextAreaElement||document.querySelector(".modal-container")||(this.initialQuery=n.key,this.showSearchModal(),n.preventDefault(),n.stopPropagation())))},document.addEventListener("keydown",this.globalKeyHandler,!0)}showSearchModal(){if(document.querySelector(".modal-container"))return;new P(this.app,this.plugin,t=>{this.app.workspace.openLinkText(t.path,"",!1)},this.initialQuery).open(),this.initialQuery=""}removeGlobalKeyListener(){this.globalKeyHandler&&document.removeEventListener("keydown",this.globalKeyHandler,!0)}hasUpdate(){let n=this.plugin.manifest.version,t=this.plugin.settings.latestVersion;if(!t)return!1;let e=n.split(".").map(Number),s=t.split(".").map(Number);for(let i=0;i<Math.max(e.length,s.length);i++){let a=e[i]||0,r=s[i]||0;if(r>a)return!0;if(r<a)return!1}return!1}createUpdateBadge(){let n=this.createElement("div","update-badge");n.setAttribute("title",o("new_version_available"));let t=this.createElement("span","update-badge-icon","\u{1F389}"),e=this.createElement("span","update-badge-text",o("update_to_version").replace("{version}",this.plugin.settings.latestVersion));return n.appendChild(t),n.appendChild(e),n.addEventListener("click",()=>{let s=this.app.setting;s.open(),setTimeout(()=>{s.openTabById("community-plugins")},100)}),n}};var m="start-page-view",v=class extends w.ItemView{constructor(t,e,s){super(t);this.refreshTimer=null;this.REFRESH_INTERVAL=6e4;this.isScrollEventRegistered=!1;this.app=e,this.plugin=s,this.navigation=!0,this.icon="home",this.contentEl.addClass("start-page-view"),this.debouncedSaveScrollPosition=(0,w.debounce)(()=>{this.saveScrollPosition()},300),this.plugin.settings.showTitleNavigationBar==="show"?this.showTitleNavigationBar(!0):this.plugin.settings.showTitleNavigationBar==="hide"?this.showTitleNavigationBar(!1):w.Platform.isDesktop?this.showTitleNavigationBar(!1):this.showTitleNavigationBar(!0)}getViewType(){return m}getDisplayText(){return o("start_page")}getIcon(){return"home"}canClose(){return!0}async onOpen(){await this.renderContent(),this.restoreScrollPosition(),this.fileChangeEventRef=this.app.vault.on("modify",()=>{this.renderContent()}),this.fileCreateEventRef=this.app.vault.on("create",()=>{this.renderContent()}),this.fileDeleteEventRef=this.app.vault.on("delete",()=>{this.renderContent()}),this.fileRenameEventRef=this.app.vault.on("rename",()=>{this.renderContent()}),this.registerDomEvent(this.containerEl,"contextmenu",t=>{let e=new w.Menu;e.addItem(s=>{s.setTitle(o("refresh")).setIcon("refresh-cw").onClick(()=>this.renderContent())}),e.showAtPosition({x:t.clientX,y:t.clientY})})}async onClose(){this.startPageCreator&&this.startPageCreator.destroy(),this.fileChangeEventRef&&this.app.vault.offref(this.fileChangeEventRef),this.fileCreateEventRef&&this.app.vault.offref(this.fileCreateEventRef),this.fileDeleteEventRef&&this.app.vault.offref(this.fileDeleteEventRef),this.fileRenameEventRef&&this.app.vault.offref(this.fileRenameEventRef),this.clearRefreshTimer()}clearRefreshTimer(){this.refreshTimer!==null&&(window.clearInterval(this.refreshTimer),this.refreshTimer=null)}startRefreshTimerIfNeeded(t,e){this.clearRefreshTimer(),t.concat(e).some(i=>Date.now()-i.stat.mtime<24*60*60*1e3)&&(this.refreshTimer=window.setInterval(()=>{this.updateModifiedTimes()},this.REFRESH_INTERVAL))}async updateModifiedTimes(){if(!this.startPageCreator)return;let t=this.getTFiles(this.plugin.settings.pinnedNotes),e=this.getRecentNotes(this.plugin.settings.recentNotesLimit),s=t.concat(e).filter(i=>Date.now()-i.stat.mtime<24*60*60*1e3);s.length>0&&await this.startPageCreator.updateNoteModifiedTimes(s)}async renderContent(){let t=this.containerEl.children[1];this.isScrollEventRegistered||(this.registerDomEvent(t,"scroll",()=>{this.debouncedSaveScrollPosition()}),this.isScrollEventRegistered=!0),this.startPageCreator||(this.startPageCreator=new R(this.app,this.plugin,t));let e=this.getTFiles(this.plugin.settings.pinnedNotes),s=this.getRecentNotes(this.plugin.settings.recentNotesLimit);await this.startPageCreator.createStartPage(e,s),this.startRefreshTimerIfNeeded(e,s)}saveScrollPosition(){let t=document.querySelector(".start-page-container");t&&(this.plugin.settings.scrollPosition=t.scrollTop,this.plugin.saveSettings())}restoreScrollPosition(){let t=document.querySelector(".start-page-container");t&&this.plugin.settings.scrollPosition>0&&setTimeout(()=>{t.scrollTop=this.plugin.settings.scrollPosition},0)}getTFiles(t){return t?t.map(s=>{let i=this.app.vault.getAbstractFileByPath(s);return i instanceof w.TFile?i:null}).filter(s=>s!==null):[]}getRecentNotes(t){let e=this.app.workspace.getLastOpenFiles(),s=this.plugin.settings.includeAllFilesInRecent?this.app.vault.getFiles():this.app.vault.getMarkdownFiles();return s.length===0?[]:s.map(a=>{let r=0,d=e.indexOf(a.path);d!==-1&&(r=Date.now()-d*60*1e3);let c=Math.max(a.stat.mtime,r);return{file:a,lastTime:c}}).sort((a,r)=>r.lastTime-a.lastTime).slice(0,t).map(a=>a.file)}showTitleNavigationBar(t){let e=this.containerEl.querySelector('.workspace-leaf-content[data-type="start-page-view"] .view-header');e&&(e.style.display=t?"":"none")}};var l=require("obsidian");var q=require("obsidian"),M=class extends q.SuggestModal{constructor(t,e){super(t);this.onChooseItem=e}getSuggestions(t){return this.app.vault.getFiles().filter(e=>e.path.toLowerCase().includes(t.toLowerCase()))}renderSuggestion(t,e){e.setText(t.path)}onChooseSuggestion(t,e){this.onChooseItem(t)}};var V=require("obsidian"),D=class extends V.SuggestModal{constructor(t,e){super(t);this.onChooseItem=e}getSuggestions(t){let e=[],s=this.app.vault.getAllLoadedFiles().filter(a=>a instanceof V.TFolder);e.push(...s);let i=this.app.vault.getFiles();return e.push(...i),e.filter(a=>a.path.toLowerCase().includes(t.toLowerCase()))}renderSuggestion(t,e){let s=e.createDiv({cls:"file-folder-suggest-item"});t instanceof V.TFolder?s.createSpan({cls:"suggest-type",text:"[Folder] "}):s.createSpan({cls:"suggest-type",text:"[File] "}),s.createSpan({text:t.path})}onChooseSuggestion(t,e){this.onChooseItem(t)}};var B=class extends l.PluginSettingTab{constructor(t,e){super(t,e);this.plugin=e}refreshStartPage(){this.app.workspace.getLeavesOfType(m).forEach(e=>{e.view instanceof v&&e.view.renderContent()})}async moveNote(t,e){let s=[...this.plugin.settings.pinnedNotes],[i]=s.splice(t,1);s.splice(e,0,i),this.plugin.settings.pinnedNotes=s,await this.plugin.saveSettings(),this.refreshStartPage(),this.display()}updateTitleNavigationBar(){this.app.workspace.getLeavesOfType(m).forEach(e=>{if(e.view instanceof v){let s=e.view;this.plugin.settings.showTitleNavigationBar==="show"?s.showTitleNavigationBar(!0):this.plugin.settings.showTitleNavigationBar==="hide"?s.showTitleNavigationBar(!1):s.showTitleNavigationBar(!l.Platform.isDesktop)}})}updateFootComponentDisabledState(){this.customFooterTextComponent&&this.customFooterTextComponent.setDisabled(!this.plugin.settings.showCustomFooterText||this.plugin.settings.useRandomFooterText),this.useRandomFooterTextComponent&&this.useRandomFooterTextComponent.setDisabled(!this.plugin.settings.showCustomFooterText)}async importFromBookmarks(){var t,e;try{let s=(t=this.app.internalPlugins)==null?void 0:t.getPluginById("bookmarks");if(!s||!s.enabled){new l.Notice(o("import_bookmarks_no_bookmarks"));return}let i=((e=s.instance)==null?void 0:e.items)||[],a=[],r=g=>{for(let u of g)u.type==="file"&&u.path?a.push(u.path):u.type==="group"&&u.items&&r(u.items)};if(r(i),a.length===0){new l.Notice(o("import_bookmarks_no_bookmarks"));return}let d=a.filter(g=>!this.plugin.settings.pinnedNotes.includes(g));if(d.length===0){new l.Notice(o("import_bookmarks_already_exist"));return}this.plugin.settings.pinnedNotes.push(...d),await this.plugin.saveSettings(),this.refreshStartPage(),this.display();let c=o("import_bookmarks_success").replace("{count}",d.length.toString());new l.Notice(c)}catch(s){console.error("Error importing bookmarks:",s),new l.Notice(o("import_bookmarks_no_bookmarks"))}}display(){let{containerEl:t}=this;t.empty(),this.createGeneralSettings(t),this.createAppearanceSettings(t),this.createNewTabSettings(t),this.createSearchSettings(t),this.createFooterSettings(t),this.createPinnedNotesSettings(t),setTimeout(()=>{this.updateFootComponentDisabledState()},0)}createGeneralSettings(t){new l.Setting(t).setName(o("general_settings_heading")).setHeading(),new l.Setting(t).setName(o("include_all_files_in_recent")).setDesc(o("include_all_files_in_recent_desc")).addToggle(e=>{e.setValue(this.plugin.settings.includeAllFilesInRecent),e.onChange(async s=>{this.plugin.settings.includeAllFilesInRecent=s,await this.plugin.saveSettings(),this.refreshStartPage()})}),new l.Setting(t).setName(o("recent_notes_limit")).setDesc(o("recent_notes_limit_desc")).addDropdown(e=>{for(let s=5;s<=50;s+=5)e.addOption(s.toString(),s.toString());e.setValue(this.plugin.settings.recentNotesLimit.toString()),e.onChange(async s=>{this.plugin.settings.recentNotesLimit=parseInt(s),await this.plugin.saveSettings(),this.refreshStartPage()})})}createAppearanceSettings(t){new l.Setting(t).setName(o("appearance_settings_heading")).setHeading(),new l.Setting(t).setName(o("show_title_navigation_bar")).setDesc(o("show_title_navigation_bar_desc")).addDropdown(e=>{e.addOption("default",o("show_title_navigation_bar_default")),e.addOption("show",o("show_title_navigation_bar_show")),e.addOption("hide",o("show_title_navigation_bar_hide")),e.setValue(this.plugin.settings.showTitleNavigationBar),e.onChange(async s=>{this.plugin.settings.showTitleNavigationBar=s,await this.plugin.saveSettings(),this.updateTitleNavigationBar()})}),new l.Setting(t).setName(o("show_stat_bar")).setDesc(o("show_stat_bar_desc")).addToggle(e=>{e.setValue(this.plugin.settings.showStatBar),e.onChange(async s=>{this.plugin.settings.showStatBar=s,await this.plugin.saveSettings(),this.refreshStartPage()})})}createNewTabSettings(t){new l.Setting(t).setName(o("new_tab_settings_heading")).setHeading(),new l.Setting(t).setName(o("replace_new_tab")).setDesc(o("replace_new_tab_desc")).addToggle(e=>{e.setValue(this.plugin.settings.replaceNewTab),e.onChange(async s=>{this.plugin.settings.replaceNewTab=s,await this.plugin.saveSettings()})})}createSearchSettings(t){new l.Setting(t).setName(o("search_settings_heading")).setHeading(),new l.Setting(t).setName(o("search_exclude_list")).setDesc(o("search_exclude_list_desc")).addButton(e=>{e.setButtonText(o("search_exclude_list_add_button")).onClick(()=>{new D(this.app,async s=>{this.plugin.settings.excludeList.includes(s.path)||(this.plugin.settings.excludeList.push(s.path),await this.plugin.saveSettings(),this.display())}).open()})}),this.displayCurrentExcludeList(t)}displayCurrentExcludeList(t){if(this.plugin.settings.excludeList.length===0)return;new l.Setting(t).setName(o("current_search_exclude_list")).setHeading();let e=t.createEl("ul",{cls:"pinned-note-list"});this.plugin.settings.excludeList.forEach((s,i)=>{this.createExcludeListItem(e,s,i)})}createExcludeListItem(t,e,s){let i=t.createEl("li",{cls:"exclude-list-item"}),r=this.app.vault.getAbstractFileByPath(e)instanceof l.TFolder,d=i.createSpan({cls:"exclude-item-icon"}),c=r?p.createFolderIcon():p.createFileIcon("md");d.appendChild(c),i.createEl("div",{cls:"exclude-item-path"}).createEl("span",{cls:"exclude-item-path-text",text:e}).setAttr("title",e);let x=i.createEl("div",{cls:"exclude-item-actions"});this.createExcludeListRemoveButton(x,e)}createExcludeListRemoveButton(t,e){let s=t.createEl("button",{cls:"mod-warning remove-button control-button icon-button"});s.setAttr("aria-label",o("search_exclude_list_remove")),s.setAttr("title",o("search_exclude_list_remove"));let i=p.createRemoveIcon();s.appendChild(i),s.onclick=async()=>{this.plugin.settings.excludeList=this.plugin.settings.excludeList.filter(a=>a!==e),await this.plugin.saveSettings(),this.display()}}createFooterSettings(t){new l.Setting(t).setName(o("footer_settings_heading")).setHeading(),new l.Setting(t).setName(o("show_custom_footer_text")).setDesc(o("show_custom_footer_text_desc")).addToggle(e=>{e.setValue(this.plugin.settings.showCustomFooterText),e.onChange(async s=>{this.plugin.settings.showCustomFooterText=s,s||(this.plugin.settings.useRandomFooterText=!1,this.useRandomFooterTextComponent.setValue(!1)),await this.plugin.saveSettings(),this.updateFootComponentDisabledState(),this.refreshStartPage()})}),new l.Setting(t).setName(o("use_random_footer_text")).setDesc(o("use_random_footer_text_desc")).addToggle(e=>{this.useRandomFooterTextComponent=e,e.setValue(this.plugin.settings.useRandomFooterText),e.onChange(async s=>{this.plugin.settings.useRandomFooterText=s,await this.plugin.saveSettings(),this.updateFootComponentDisabledState(),this.refreshStartPage()})}),new l.Setting(t).setName(o("custom_footer_text")).setDesc(o("custom_footer_text_desc")).addText(e=>{this.customFooterTextComponent=e,e.setValue(this.plugin.settings.customFooterText),e.onChange(async s=>{this.plugin.settings.customFooterText=s,await this.plugin.saveSettings(),this.updateFootComponentDisabledState(),this.refreshStartPage()})})}createPinnedNotesSettings(t){this.createPinnedNotesHeading(t),this.createNoteSelectionButton(t),this.displayCurrentPinnedNotes(t)}createPinnedNotesHeading(t){new l.Setting(t).setName(o("pinned_notes_settings_heading")).setHeading()}createNoteSelectionButton(t){new l.Setting(t).setName(o("pinned_notes_select")).setDesc(o("pinned_notes_select_desc")).addButton(e=>{e.setButtonText(o("pinned_notes_select_button")).onClick(()=>{new M(this.app,async s=>{this.plugin.settings.pinnedNotes.includes(s.path)||(this.plugin.settings.pinnedNotes.push(s.path),await this.plugin.saveSettings(),this.refreshStartPage(),this.display())}).open()})}),new l.Setting(t).setName(o("pinned_notes_import_from_bookmarks")).setDesc(o("pinned_notes_import_from_bookmarks_desc")).addButton(e=>{e.setButtonText(o("pinned_notes_import_from_bookmarks_button")).onClick(async()=>{await this.importFromBookmarks()})})}displayCurrentPinnedNotes(t){if(this.plugin.settings.pinnedNotes.length===0)return;new l.Setting(t).setName(o("current_pinned_notes")).setHeading();let e=t.createEl("ul",{cls:"pinned-note-list"});this.plugin.settings.pinnedNotes.forEach((s,i)=>{this.createPinnedNoteListItem(e,s,i)})}createPinnedNoteListItem(t,e,s){var f;let i=t.createEl("li",{cls:"pinned-note-item"});if(!this.app.vault.getAbstractFileByPath(e))return;let r=(f=e.split("/").pop())!=null?f:e;i.createEl("div",{cls:"note-line1"}).createEl("span",{cls:"note-title",text:r});let c=i.createEl("div",{cls:"note-line2"}),g=c.createEl("div",{cls:"note-path"}),u=g.createSpan({cls:"folder-icon"}),x=p.createFolderIcon();u.appendChild(x);let T=_.getDirPath(e);g.createEl("span",{cls:"note-path-text",text:_.truncateMiddle(T)}).setAttr("title",T);let b=c.createEl("div",{cls:"note-actions"});this.createNoteControlButtons(b,e,s)}createNoteControlButtons(t,e,s){this.createMoveUpButton(t,s),this.createMoveDownButton(t,s),this.createRemoveButton(t,e)}createMoveUpButton(t,e){if(e>0){let s=t.createEl("button",{cls:"control-button icon-button"});s.setAttr("aria-label",o("move_up")),s.setAttr("title",o("move_up"));let i=p.createArrowUpIcon();s.appendChild(i),s.onclick=async()=>{await this.moveNote(e,e-1)}}}createMoveDownButton(t,e){if(e<this.plugin.settings.pinnedNotes.length-1){let s=t.createEl("button",{cls:"control-button icon-button"});s.setAttr("aria-label",o("move_down")),s.setAttr("title",o("move_down"));let i=p.createArrowDownIcon();s.appendChild(i),s.onclick=async()=>{await this.moveNote(e,e+1)}}}createRemoveButton(t,e){let s=t.createEl("button",{cls:"mod-warning remove-button control-button icon-button"});s.setAttr("aria-label",o("pinned_notes_remove")),s.setAttr("title",o("pinned_notes_remove"));let i=p.createRemoveIcon();s.appendChild(i),s.onclick=async()=>{this.plugin.settings.pinnedNotes=this.plugin.settings.pinnedNotes.filter(a=>a!==e),await this.plugin.saveSettings(),this.refreshStartPage(),this.display()}}};var Y=require("obsidian"),N=class{static async checkForUpdate(n){var t,e;try{let s=await(0,Y.requestUrl)({url:this.GITHUB_API_URL,method:"GET",headers:{Accept:"application/vnd.github.v3+json"}});if(s.status!==200)return console.warn("Failed to check for updates:",s.status),null;let i=s.json,a=((t=i.tag_name)==null?void 0:t.replace(/^v/,""))||((e=i.name)==null?void 0:e.replace(/^v/,""));return a?{hasUpdate:this.compareVersions(a,n)>0,latestVersion:a,currentVersion:n,releaseUrl:this.GITHUB_RELEASE_URL}:(console.warn("Could not determine latest version"),null)}catch(s){return console.error("Error checking for updates:",s),null}}static compareVersions(n,t){let e=n.split(".").map(Number),s=t.split(".").map(Number);for(let i=0;i<Math.max(e.length,s.length);i++){let a=e[i]||0,r=s[i]||0;if(a>r)return 1;if(a<r)return-1}return 0}};N.GITHUB_API_URL="https://api.github.com/repos/kuzzh/obsidian-startpage/releases/latest",N.GITHUB_RELEASE_URL="https://github.com/kuzzh/obsidian-startpage/releases";var H=class extends k.Plugin{async onload(){await this.loadSettings(),this.settings.scrollPosition=0,this.saveSettings();let t=(0,k.getLanguage)()||"en";$(t),this.registerView(m,e=>new v(e,this.app,this)),this.checkForUpdates(),this.addRibbonIcon("home","Open start page",()=>{this.activateStartPage()}),this.addSettingTab(new B(this.app,this)),this.addCommand({id:"open-start-page",name:o("open_start_page"),callback:()=>{this.activateStartPage()}}),this.addCommand({id:"open-start-page-new-tab",name:o("open_start_page_new_tab"),callback:()=>{this.activateStartPageNewTab()}}),this.registerEvent(this.app.workspace.on("active-leaf-change",e=>{var s;if(this.settings.replaceNewTab&&e&&!e.view.getViewType().startsWith(m)){let i=e.getViewState();i.type==="empty"&&!((s=i.state)!=null&&s.file)&&this.replaceWithStartPage(e)}})),this.registerEvent(this.app.workspace.on("file-menu",(e,s)=>{s instanceof k.TFile&&this.addPinnedNoteMenuItem(e,s)}))}async loadSettings(){await this.backupSettings();let t=await this.loadData();t&&typeof t=="object"?this.settings={...U,...t,pinnedNotes:Array.isArray(t.pinnedNotes)?t.pinnedNotes:[],recentNotesLimit:typeof t.recentNotesLimit=="number"?t.recentNotesLimit:10,includeAllFilesInRecent:typeof t.includeAllFilesInRecent=="boolean"?t.includeAllFilesInRecent:!0,replaceNewTab:typeof t.replaceNewTab=="boolean"?t.replaceNewTab:!0,showTitleNavigationBar:["default","show","hide"].includes(t.showTitleNavigationBar)?t.showTitleNavigationBar:"default",showCustomFooterText:typeof t.showCustomFooterText=="boolean"?t.showCustomFooterText:!1,useRandomFooterText:typeof t.useRandomFooterText=="boolean"?t.useRandomFooterText:!1,todayRandomEnFooterText:typeof t.todayRandomEnFooterText=="string"?t.todayRandomEnFooterText:"",todayRandomZhFooterText:typeof t.todayRandomZhFooterText=="string"?t.todayRandomZhFooterText:"",customFooterText:typeof t.customFooterText=="string"?t.customFooterText:"",scrollPosition:typeof t.scrollPosition=="number"?t.scrollPosition:0,showStatBar:typeof t.showStatBar=="boolean"?t.showStatBar:!0,lastVersionCheck:typeof t.lastVersionCheck=="number"?t.lastVersionCheck:0,latestVersion:typeof t.latestVersion=="string"?t.latestVersion:"",excludeList:Array.isArray(t.excludeList)?t.excludeList:[]}:this.settings={...U}}async backupSettings(){let t=this.manifest.dir+"/backup",e=`${t}/data-${new Date().toISOString().slice(0,10)}.json`;if(!await this.app.vault.adapter.exists(e)){await this.app.vault.adapter.mkdir(t);let i=this.manifest.dir+"/data.json";if(await this.app.vault.adapter.exists(i)){let a=await this.app.vault.adapter.read(i);await this.app.vault.adapter.write(e,a)}else console.log("data.json file does not exist, skipping backup")}}async saveSettings(){await this.saveData(this.settings)}findStartPageLeaf(){let t=this.app.workspace.getLeavesOfType(m);return t.length>0?t[0]:null}async activateStartPage(){try{let t=this.app.workspace.getLeaf(!1);t&&await t.setViewState({type:m,active:!0})}catch(t){console.error("Failed to create Start Page leaf:",t)}}async activateStartPageNewTab(){try{let t=this.app.workspace.getLeaf(!0);t&&await t.setViewState({type:m,active:!0})}catch(t){console.error("Failed to create Start Page leaf in new tab:",t)}}async replaceWithStartPage(t){try{await t.setViewState({type:m,active:!0})}catch(e){console.error("Failed to replace with Start Page:",e)}}addPinnedNoteMenuItem(t,e){let s=this.settings.pinnedNotes.includes(e.path);t.addItem(i=>{i.setTitle(s?o("remove_from_pinned_notes"):o("add_to_pinned_notes")).setIcon(s?"pin-off":"pin").onClick(async()=>{s?this.settings.pinnedNotes=this.settings.pinnedNotes.filter(r=>r!==e.path):this.settings.pinnedNotes.push(e.path),await this.saveSettings(),this.app.workspace.getLeavesOfType(m).forEach(r=>{r.view instanceof v&&r.view.renderContent()})})})}onunload(){this.app.workspace.getLeavesOfType(m).forEach(t=>t.detach())}async checkForUpdates(){let t=Date.now(),e=24*60*60*1e3;if(!(t-this.settings.lastVersionCheck<e))try{let s=await N.checkForUpdate(this.manifest.version);s&&s.hasUpdate?(this.settings.latestVersion=s.latestVersion,this.settings.lastVersionCheck=t,await this.saveSettings(),this.app.workspace.getLeavesOfType(m).forEach(a=>{a.view instanceof v&&a.view.renderContent()})):(this.settings.lastVersionCheck=t,await this.saveSettings())}catch(s){console.error("Error checking for updates:",s)}}};

/* nosourcemap */